---
import Layout from '../../../layouts/Layout.astro';
import ProgressDetail from '../../../components/ProgressDetail.astro';
import { loadTranslations, type Locale } from '../../../utils/i18n';

// Función para generar las rutas estáticas
export async function getStaticPaths() {
  const days = [1, 2, 3, 4, 5, 6, 7];
  
  return days.map(day => ({
    params: { day: `day-${day}` }
  }));
}

const locale: Locale = 'es';
const translations = await loadTranslations(locale);

// Obtener el día de la URL
const { day } = Astro.params;
const dayNumber = parseInt(day?.replace('day-', '') || '1');

// Cargar las actualizaciones de progreso
const progressData = await import(`../../../data/progress-updates-${locale}.json`);
const allUpdates = progressData.default.updates;

// Encontrar la actualización del día específico
const update = allUpdates.find(u => u.day === dayNumber);

if (!update) {
  throw new Error(`No se encontró la actualización para el día ${dayNumber}`);
}
---

<Layout 
  title={`${update.title} - Hacker Days`}
  description={update.description.substring(0, 160) + '...'}
  lang={locale}
>
  <ProgressDetail 
    locale={locale}
    translations={translations}
    update={update}
    currentPath={Astro.url.pathname}
    allUpdates={allUpdates}
  />
</Layout>
